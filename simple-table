import sys
import subprocess

class Table(object):
  def __init__(self, *args):
    if len(args) == 1 and type(args[0]) in (list, tuple):
      self.headings = args[0]
    else:
      self.headings = args

    self.p = subprocess.Popen(['column', '-t', '-s\t'], stdin=subprocess.PIPE)
    self.p.stdin.write(self.encode('\t'.join([str(heading) for heading in self.headings]) + '\n'))

  @classmethod
  def encode(cls, s):
    return s if sys.version_info.major == 2 else s.encode()

  def add(self, *args):
    self.p.stdin.write(self.encode('\t'.join([str(arg) for arg in args]) + '\n'))

  def close(self):
    self.p.stdin.close()
    self.p.wait()
